{"version":3,"file":"from-ol-change-event.js","sources":["src/rx-ext/from-ol-change-event.js"],"sourcesContent":["import { merge as mergeObs } from 'rxjs/observable'\nimport { distinctUntilChanged, map as mapObs, debounceTime } from 'rxjs/operators'\nimport { isEqual, isFunction } from '../util/minilo'\nimport fromOlEvent from './from-ol-event'\n\n/**\n * Creates Observable from OpenLayers change:* event\n * @param {module:ol/Observable~Observable} target\n * @param {string|string[]} [prop]\n * @param {boolean|function(a, b):boolean|undefined} [distinct] Distinct values by isEqual fn or by custom comparator\n * @param {number|undefined} [debounce] Debounce values by passed amount of ms.\n * @param {function|undefined} [selector] Custom selector\n * @return {Observable<{prop: string, value: *}>}\n */\nexport default function fromOlChangeEvent (target, prop, distinct, debounce, selector) {\n  if (Array.isArray(prop)) {\n    return mergeObs(...prop.map(p => fromOlChangeEvent(target, p)))\n  }\n\n  selector = selector || ((target, prop) => target.get(prop))\n  let event = `change:${prop}`\n  let observable = fromOlEvent(target, event, () => selector(target, prop))\n  let operations = []\n\n  if (debounce != null) {\n    operations.push(debounceTime(debounce))\n  }\n  if (distinct) {\n    isFunction(distinct) || (distinct = isEqual)\n    operations.push(distinctUntilChanged(distinct))\n  }\n\n  operations.push(mapObs(value => ({ prop, value })))\n\n  return observable.pipe(...operations)\n}\n"],"names":["fromOlChangeEvent","target","prop","distinct","debounce","selector","Array","isArray","mergeObs","map","p","get","event","observable","fromOlEvent","operations","push","debounceTime","isFunction","isEqual","distinctUntilChanged","mapObs","value","pipe"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAKA;;;;;;;;;;AASA,AAAe,SAASA,iBAAT,CAA4BC,MAA5B,EAAoCC,IAApC,EAA0CC,QAA1C,EAAoDC,QAApD,EAA8DC,QAA9D,EAAwE;MACjFC,KAAK,CAACC,OAAN,CAAcL,IAAd,CAAJ,EAAyB;WAChBM,KAAQ,MAAR,4BAAYN,IAAI,CAACO,GAAL,CAAS,UAAAC,CAAC;aAAIV,iBAAiB,CAACC,MAAD,EAASS,CAAT,CAArB;KAAV,CAAZ,EAAP;;;EAGFL,QAAQ,GAAGA,QAAQ,IAAK,UAACJ,MAAD,EAASC,IAAT;WAAkBD,MAAM,CAACU,GAAP,CAAWT,IAAX,CAAlB;GAAxB;;MACIU,KAAK,oBAAaV,IAAb,CAAT;MACIW,UAAU,GAAGC,WAAW,CAACb,MAAD,EAASW,KAAT,EAAgB;WAAMP,QAAQ,CAACJ,MAAD,EAASC,IAAT,CAAd;GAAhB,CAA5B;MACIa,UAAU,GAAG,EAAjB;;MAEIX,QAAQ,IAAI,IAAhB,EAAsB;IACpBW,UAAU,CAACC,IAAX,CAAgBC,YAAY,CAACb,QAAD,CAA5B;;;MAEED,QAAJ,EAAc;IACZe,UAAU,CAACf,QAAD,CAAV,KAAyBA,QAAQ,GAAGgB,OAApC;IACAJ,UAAU,CAACC,IAAX,CAAgBI,oBAAoB,CAACjB,QAAD,CAApC;;;EAGFY,UAAU,CAACC,IAAX,CAAgBK,GAAM,CAAC,UAAAC,KAAK;WAAK;MAAEpB,IAAI,EAAJA,IAAF;MAAQoB,KAAK,EAALA;KAAb;GAAN,CAAtB;SAEOT,UAAU,CAACU,IAAX,OAAAV,UAAU,EAASE,UAAT,CAAjB;;;;;"}